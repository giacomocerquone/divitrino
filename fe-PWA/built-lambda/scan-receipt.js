!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("zlib")},function(e,t){e.exports=require("url")},function(e,t){e.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`},function(e,t){let r=!1;t.logging=r,t.setLogging=e=>{r=e},t.log=(...e)=>r?console.log.apply(this,e):null},function(e,t){e.exports=require("http")},function(e,t,r){const n=r(3);let o=0;e.exports=({id:e,action:t,payload:r={}})=>{let i=e;return void 0===i&&(i=n("Job",o),o+=1),{id:i,action:t,payload:r}}},function(e,t,r){const n=r(16),o=r(20),i=r(6),{log:a}=r(4),s=r(3),{defaultOEM:l}=r(21),{defaultOptions:c,spawnWorker:u,terminateWorker:f,onMessage:p,loadImage:h,send:m}=r(22);let d=0;e.exports=(e={})=>{const t=s("Worker",d),{logger:r,errorHandler:y,...g}=n({...c,...e}),b={},S={};let v=u(g);d+=1;const w=(e,t)=>{b[e]=t},P=(e,t)=>{S[e]=t},x=({id:e,action:r,payload:n})=>new Promise((o,i)=>{a(`[${t}]: Start ${e}, action=${r}`),w(r,o),P(r,i),m(v,{workerId:t,jobId:e,action:r,payload:n})});return p(v,({workerId:e,jobId:t,status:n,action:i,data:s})=>{if("resolve"===n){a(`[${e}]: Complete ${t}`);let r=s;"recognize"===i?r=o(s):"getPDF"===i&&(r=Array.from({...s,length:Object.keys(s).length})),b[i]({jobId:t,data:r})}else if("reject"===n){if(S[i](s),!y)throw Error(s);y(s)}else"progress"===n&&r(s)}),{id:t,worker:v,setResolve:w,setReject:P,load:e=>x(i({id:e,action:"load",payload:{options:g}})),writeText:(e,t,r)=>x(i({id:r,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>x(i({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>x(i({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,r)=>x(i({id:r,action:"FS",payload:{method:e,args:t}})),loadLanguage:(e="eng",t)=>x(i({id:t,action:"loadLanguage",payload:{langs:e,options:g}})),initialize:(e="eng",t=l,r)=>x(i({id:r,action:"initialize",payload:{langs:e,oem:t}})),setParameters:(e={},t)=>x(i({id:t,action:"setParameters",payload:{params:e}})),recognize:async(e,t={},r)=>x(i({id:r,action:"recognize",payload:{image:await h(e),options:t}})),getPDF:(e="Tesseract OCR Result",t=!1,r)=>x(i({id:r,action:"getPDF",payload:{title:e,textonly:t}})),detect:async(e,t)=>x(i({id:t,action:"detect",payload:{image:await h(e)}})),terminate:async()=>(null!==v&&(f(v),v=null),Promise.resolve())}}},function(e,t){e.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("https")},function(e,t,r){const{createWorker:n}=r(13);t.handler=async(e,t,r)=>{try{const t=JSON.parse(e.body);console.log("Function `scan-receipt` invoked",t);const o=t.base64,i=await o.toBuffer(),{data:{text:a,hocr:s,tsv:l,box:c,unlv:u}}=await async function(e){const t=n({gzip:!1,logger:e=>null});await t.load(),await t.loadLanguage("eng"),await t.initialize("eng");const r=await t.recognize(e);return await t.terminate(),r}(i),f=function(e){return e.split("\n").filter(e=>e).map(e=>{const t=e.split(" ");return{price:t.slice(-1)[0],descr:t.slice(0,t.length-1).join(" ")}})}(a);console.log(a,f),r(null,{statusCode:200,body:JSON.stringify(f)})}catch(e){return console.log(e),r(null,{statusCode:500,body:JSON.stringify(e)})}}},function(e,t,r){r(14);const n=r(15),o=r(7),i=r(41),a=r(8),s=r(42),{setLogging:l}=r(4);e.exports={OEM:a,PSM:s,createScheduler:n,createWorker:o,setLogging:l,...i}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof f?t:f,i=Object.create(o.prototype),a=new x(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return C()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=v(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function f(){}function p(){}function h(){}var m={};m[o]=function(){return this};var d=Object.getPrototypeOf,y=d&&d(d(L([])));y&&y!==t&&r.call(y,o)&&(m=y);var g=h.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var n;this._invoke=function(o,i){function a(){return new t((function(n,a){!function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(f).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function v(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,v(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function L(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return p.prototype=g.constructor=h,h.constructor=p,p.displayName=s(h,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(S.prototype),S.prototype[i]=function(){return this},e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(g),s(g,a,"Generator"),g[o]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=L,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:L(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){const n=r(6),{log:o}=r(4),i=r(3);let a=0;e.exports=()=>{const e=i("Scheduler",a),t={},r={};let s=[];a+=1;const l=()=>Object.keys(t).length,c=()=>{if(0!==s.length){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)if(void 0===r[e[n]]){s[0](t[e[n]]);break}}},u=(t,i)=>new Promise((a,l)=>{const u=n({action:t,payload:i});s.push(async e=>{s.shift(),r[e.id]=u;try{a(await e[t].apply(this,[...i,u.id]))}catch(e){l(e)}finally{delete r[e.id],c()}}),o(`[${e}]: Add ${u.id} to JobQueue`),o(`[${e}]: JobQueue length=${s.length}`),c()});return{addWorker:r=>(t[r.id]=r,o(`[${e}]: Add ${r.id}`),o(`[${e}]: Number of workers=${l()}`),c(),r.id),addJob:async(t,...r)=>{if(0===l())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return u(t,r)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),s=[]},getQueueLen:()=>s.length,getNumWorkers:l}}},function(e,t,r){const n="browser"===r(17)("type")?r(19):e=>e;e.exports=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(r=>{void 0!==e[r]&&(t[r]=n(t[r]))}),t}},function(e,t,r){const n=r(18);e.exports=e=>{const t={};return"undefined"!=typeof WorkerGlobalScope?t.type="webworker":"object"==typeof window?t.type="browser":n()?t.type="electron":"object"==typeof process&&(t.type="node"),void 0===e?t:t[e]}},function(e,t){e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},function(e,t,r){var n,o;void 0===(o="function"==typeof(n=function(){return function(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var t=document.createElement("base");if(t.href=arguments[0],1===e)return t.href;var r=document.getElementsByTagName("head")[0];r.insertBefore(t,r.firstChild);for(var n,o=document.createElement("a"),i=1;i<e;i++)o.href=arguments[i],n=o.href,t.href=n;return r.removeChild(t),n}})?n.call(t,r,t,e):n)||(e.exports=o)},function(e,t){e.exports=e=>{const t=[],r=[],n=[],o=[],i=[];return e.blocks.forEach(a=>{a.paragraphs.forEach(t=>{t.lines.forEach(r=>{r.words.forEach(n=>{n.symbols.forEach(o=>{i.push({...o,page:e,block:a,paragraph:t,line:r,word:n})}),o.push({...n,page:e,block:a,paragraph:t,line:r})}),n.push({...r,page:e,block:a,paragraph:t})}),r.push({...t,page:e,block:a})}),t.push({...a,page:e})}),{...e,blocks:t,paragraphs:r,lines:n,words:o,symbols:i}}},function(e,t,r){const n=r(8);e.exports={defaultOEM:n.DEFAULT}},function(e,t,r){const n=r(23),o=r(26),i=r(28),a=r(29),s=r(30),l=r(31);e.exports={defaultOptions:n,spawnWorker:o,terminateWorker:i,onMessage:a,send:s,loadImage:l}},function(e,t,r){(function(t){const n=r(24),o=r(25);e.exports={...o,workerPath:n.join(t,"..","..","worker-script","node","index.js")}}).call(this,"/")},function(e,t){e.exports=require("path")},function(e,t){e.exports={langPath:"https://tessdata.projectnaptha.com/4.0.0",workerBlobURL:!0,logger:()=>{}}},function(e,t,r){const{fork:n}=r(27);let o=9229;e.exports=({workerPath:e})=>(o+=1,n(e,{execArgv:["--debug-port="+o]}))},function(e,t){e.exports=require("child_process")},function(e,t){e.exports=e=>{e.kill()}},function(e,t){e.exports=(e,t)=>{e.on("message",t)}},function(e,t){e.exports=(e,t)=>{e.send(t)}},function(e,t,r){const n=r(9),o=r(10),i=r(32),a=r(33),s=r(34),l=n.promisify(o.readFile);e.exports=async e=>{let t=e;if(void 0===e)return e;if("string"==typeof e)if(a(e)||e.startsWith("moz-extension://")||e.startsWith("chrome-extension://")||e.startsWith("file://")){const r=await i(e);t=await r.arrayBuffer()}else t=/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?Buffer.from(e.split(",")[1],"base64"):await l(e);else Buffer.isBuffer(e)&&(t=e);try{t=(await s.rotate(t,{quality:100})).buffer}catch(e){}return new Uint8Array(t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return k})),r.d(t,"Request",(function(){return H})),r.d(t,"Response",(function(){return j})),r.d(t,"FetchError",(function(){return p}));var n=r(0),o=r(5),i=r(2),a=r(11),s=r(1);const l=n.Readable,c=Symbol("buffer"),u=Symbol("type");class f{constructor(){this[u]="";const e=arguments[0],t=arguments[1],r=[];let n=0;if(e){const t=e,o=Number(t.length);for(let e=0;e<o;e++){const o=t[e];let i;i=o instanceof Buffer?o:ArrayBuffer.isView(o)?Buffer.from(o.buffer,o.byteOffset,o.byteLength):o instanceof ArrayBuffer?Buffer.from(o):o instanceof f?o[c]:Buffer.from("string"==typeof o?o:String(o)),n+=i.length,r.push(i)}}this[c]=Buffer.concat(r);let o=t&&void 0!==t.type&&String(t.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[u]=o)}get size(){return this[c].length}get type(){return this[u]}text(){return Promise.resolve(this[c].toString())}arrayBuffer(){const e=this[c],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new l;return e._read=function(){},e.push(this[c]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],r=arguments[1];let n,o;n=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),o=void 0===r?e:r<0?Math.max(e+r,0):Math.min(r,e);const i=Math.max(o-n,0),a=this[c].slice(n,n+i),s=new f([],{type:arguments[2]});return s[c]=a,s}}function p(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}let h;Object.defineProperties(f.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(f.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,p.prototype.name="FetchError";try{h=require("encoding").convert}catch(e){}const m=Symbol("Body internals"),d=n.PassThrough;function y(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.size;let i=void 0===o?0:o;var a=r.timeout;let s=void 0===a?0:a;null==e?e=null:b(e)?e=Buffer.from(e.toString()):S(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof n||(e=Buffer.from(String(e)))),this[m]={body:e,disturbed:!1,error:null},this.size=i,this.timeout=s,e instanceof n&&e.on("error",(function(e){const r="AbortError"===e.name?e:new p(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[m].error=r}))}function g(){var e=this;if(this[m].disturbed)return y.Promise.reject(new TypeError("body used already for: "+this.url));if(this[m].disturbed=!0,this[m].error)return y.Promise.reject(this[m].error);let t=this.body;if(null===t)return y.Promise.resolve(Buffer.alloc(0));if(S(t)&&(t=t.stream()),Buffer.isBuffer(t))return y.Promise.resolve(t);if(!(t instanceof n))return y.Promise.resolve(Buffer.alloc(0));let r=[],o=0,i=!1;return new y.Promise((function(n,a){let s;e.timeout&&(s=setTimeout((function(){i=!0,a(new p(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))}),e.timeout)),t.on("error",(function(t){"AbortError"===t.name?(i=!0,a(t)):a(new p(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))})),t.on("data",(function(t){if(!i&&null!==t){if(e.size&&o+t.length>e.size)return i=!0,void a(new p(`content size at ${e.url} over limit: ${e.size}`,"max-size"));o+=t.length,r.push(t)}})),t.on("end",(function(){if(!i){clearTimeout(s);try{n(Buffer.concat(r,o))}catch(t){a(new p(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}}))}))}function b(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function S(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function v(e){let t,r,o=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof n&&"function"!=typeof o.getBoundary&&(t=new d,r=new d,o.pipe(t),o.pipe(r),e[m].body=t,o=r),o}function w(e){return null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":b(e)?"application/x-www-form-urlencoded;charset=UTF-8":S(e)?e.type||null:Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)?null:"function"==typeof e.getBoundary?"multipart/form-data;boundary="+e.getBoundary():e instanceof n?null:"text/plain;charset=UTF-8"}function P(e){const t=e.body;return null===t?0:S(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}y.prototype={get body(){return this[m].body},get bodyUsed(){return this[m].disturbed},arrayBuffer(){return g.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob(){let e=this.headers&&this.headers.get("content-type")||"";return g.call(this).then((function(t){return Object.assign(new f([],{type:e.toLowerCase()}),{[c]:t})}))},json(){var e=this;return g.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return y.Promise.reject(new p(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}}))},text(){return g.call(this).then((function(e){return e.toString()}))},buffer(){return g.call(this)},textConverted(){var e=this;return g.call(this).then((function(t){return function(e,t){if("function"!=typeof h)throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=t.get("content-type");let n,o,i="utf-8";r&&(n=/charset=([^;]*)/i.exec(r));o=e.slice(0,1024).toString(),!n&&o&&(n=/<meta.+?charset=(['"])(.+?)\1/i.exec(o));!n&&o&&(n=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),n||(n=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),n&&n.pop()),n&&(n=/charset=(.*)/i.exec(n.pop())));!n&&o&&(n=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o));n&&(i=n.pop(),"gb2312"!==i&&"gbk"!==i||(i="gb18030"));return h(e,"UTF-8",i).toString()}(t,e.headers)}))}},Object.defineProperties(y.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),y.mixIn=function(e){for(const t of Object.getOwnPropertyNames(y.prototype))if(!(t in e)){const r=Object.getOwnPropertyDescriptor(y.prototype,t);Object.defineProperty(e,t,r)}},y.Promise=global.Promise;const x=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,L=/[^\t\x20-\x7e\x80-\xff]/;function C(e){if(e=""+e,x.test(e)||""===e)throw new TypeError(e+" is not a legal HTTP header name")}function E(e){if(e=""+e,L.test(e))throw new TypeError(e+" is not a legal HTTP header value")}function R(e,t){t=t.toLowerCase();for(const r in e)if(r.toLowerCase()===t)return r}const A=Symbol("map");class k{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[A]=Object.create(null),e instanceof k){const t=e.raw(),r=Object.keys(t);for(const e of r)for(const r of t[e])this.append(e,r)}else if(null==e);else{if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");{const t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw new TypeError("Header pairs must be iterable");const r=[];for(const t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw new TypeError("Each header pair must be iterable");r.push(Array.from(t))}for(const e of r){if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const r=e[t];this.append(t,r)}}}}get(e){C(e=""+e);const t=R(this[A],e);return void 0===t?null:this[A][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=T(this),n=0;for(;n<r.length;){var o=r[n];const i=o[0],a=o[1];e.call(t,a,i,this),r=T(this),n++}}set(e,t){t=""+t,C(e=""+e),E(t);const r=R(this[A],e);this[A][void 0!==r?r:e]=[t]}append(e,t){t=""+t,C(e=""+e),E(t);const r=R(this[A],e);void 0!==r?this[A][r].push(t):this[A][e]=[t]}has(e){return C(e=""+e),void 0!==R(this[A],e)}delete(e){C(e=""+e);const t=R(this[A],e);void 0!==t&&delete this[A][t]}raw(){return this[A]}keys(){return O(this,"key")}values(){return O(this,"value")}[Symbol.iterator](){return O(this,"key+value")}}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";const r=Object.keys(e[A]).sort();return r.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[A][t].join(", ")}:function(t){return[t.toLowerCase(),e[A][t].join(", ")]})}k.prototype.entries=k.prototype[Symbol.iterator],Object.defineProperty(k.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(k.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const I=Symbol("internal");function O(e,t){const r=Object.create(D);return r[I]={target:e,kind:t,index:0},r}const D=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==D)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[I];const t=e.target,r=e.kind,n=e.index,o=T(t,r);return n>=o.length?{value:void 0,done:!0}:(this[I].index=n+1,{value:o[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function B(e){const t=Object.assign({__proto__:null},e[A]),r=R(e[A],"Host");return void 0!==r&&(t[r]=t[r][0]),t}Object.defineProperty(D,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const G=Symbol("Response internals"),M=o.STATUS_CODES;class j{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y.call(this,e,t);const r=t.status||200,n=new k(t.headers);if(null!=e&&!n.has("Content-Type")){const t=w(e);t&&n.append("Content-Type",t)}this[G]={url:t.url,status:r,statusText:t.statusText||M[r],headers:n,counter:t.counter}}get url(){return this[G].url||""}get status(){return this[G].status}get ok(){return this[G].status>=200&&this[G].status<300}get redirected(){return this[G].counter>0}get statusText(){return this[G].statusText}get headers(){return this[G].headers}clone(){return new j(v(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}y.mixIn(j.prototype),Object.defineProperties(j.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(j.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const F=Symbol("Request internals"),_=i.parse,U=i.format,N="destroy"in n.Readable.prototype;function z(e){return"object"==typeof e&&"object"==typeof e[F]}class H{constructor(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};z(e)?t=_(e.url):(t=e&&e.href?_(e.href):_(""+e),e={});let n=r.method||e.method||"GET";if(n=n.toUpperCase(),(null!=r.body||z(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");let o=null!=r.body?r.body:z(e)&&null!==e.body?v(e):null;y.call(this,o,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});const i=new k(r.headers||e.headers||{});if(null!=o&&!i.has("Content-Type")){const e=w(o);e&&i.append("Content-Type",e)}let a=z(e)?e.signal:null;if("signal"in r&&(a=r.signal),null!=a&&!function(e){const t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!(!t||"AbortSignal"!==t.constructor.name)}(a))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[F]={method:n,redirect:r.redirect||e.redirect||"follow",headers:i,parsedURL:t,signal:a},this.follow=void 0!==r.follow?r.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==r.compress?r.compress:void 0===e.compress||e.compress,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[F].method}get url(){return U(this[F].parsedURL)}get headers(){return this[F].headers}get redirect(){return this[F].redirect}get signal(){return this[F].signal}clone(){return new H(this)}}function X(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}y.mixIn(H.prototype),Object.defineProperty(H.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(H.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),X.prototype=Object.create(Error.prototype),X.prototype.constructor=X,X.prototype.name="AbortError";const q=n.PassThrough,Y=i.resolve;function $(e,t){if(!$.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return y.Promise=$.Promise,new $.Promise((function(r,i){const l=new H(e,t),c=function(e){const t=e[F].parsedURL,r=new k(e[F].headers);if(r.has("Accept")||r.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof n.Readable&&!N)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let o=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(o="0"),null!=e.body){const t=P(e);"number"==typeof t&&(o=String(t))}o&&r.set("Content-Length",o),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let i=e.agent;return"function"==typeof i&&(i=i(t)),r.has("Connection")||i||r.set("Connection","close"),Object.assign({},t,{method:e.method,headers:B(r),agent:i})}(l),u=("https:"===c.protocol?a:o).request,f=l.signal;let h=null;const m=function(){let e=new X("The user aborted a request.");i(e),l.body&&l.body instanceof n.Readable&&l.body.destroy(e),h&&h.body&&h.body.emit("error",e)};if(f&&f.aborted)return void m();const d=function(){m(),b()},y=u(c);let g;function b(){y.abort(),f&&f.removeEventListener("abort",d),clearTimeout(g)}f&&f.addEventListener("abort",d),l.timeout&&y.once("socket",(function(e){g=setTimeout((function(){i(new p("network timeout at: "+l.url,"request-timeout")),b()}),l.timeout)})),y.on("error",(function(e){i(new p(`request to ${l.url} failed, reason: ${e.message}`,"system",e)),b()})),y.on("response",(function(e){clearTimeout(g);const t=function(e){const t=new k;for(const r of Object.keys(e))if(!x.test(r))if(Array.isArray(e[r]))for(const n of e[r])L.test(n)||(void 0===t[A][r]?t[A][r]=[n]:t[A][r].push(n));else L.test(e[r])||(t[A][r]=[e[r]]);return t}(e.headers);if($.isRedirect(e.statusCode)){const n=t.get("Location"),o=null===n?null:Y(l.url,n);switch(l.redirect){case"error":return i(new p("uri requested responds with a redirect, redirect mode is set to error: "+l.url,"no-redirect")),void b();case"manual":if(null!==o)try{t.set("Location",o)}catch(e){i(e)}break;case"follow":if(null===o)break;if(l.counter>=l.follow)return i(new p("maximum redirect reached at: "+l.url,"max-redirect")),void b();const n={headers:new k(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:l.body,signal:l.signal,timeout:l.timeout,size:l.size};return 303!==e.statusCode&&l.body&&null===P(l)?(i(new p("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void b()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==l.method)||(n.method="GET",n.body=void 0,n.headers.delete("content-length")),r($(new H(o,n))),void b())}}e.once("end",(function(){f&&f.removeEventListener("abort",d)}));let n=e.pipe(new q);const o={url:l.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:l.size,timeout:l.timeout,counter:l.counter},a=t.get("Content-Encoding");if(!l.compress||"HEAD"===l.method||null===a||204===e.statusCode||304===e.statusCode)return h=new j(n,o),void r(h);const c={flush:s.Z_SYNC_FLUSH,finishFlush:s.Z_SYNC_FLUSH};if("gzip"==a||"x-gzip"==a)return n=n.pipe(s.createGunzip(c)),h=new j(n,o),void r(h);if("deflate"!=a&&"x-deflate"!=a){if("br"==a&&"function"==typeof s.createBrotliDecompress)return n=n.pipe(s.createBrotliDecompress()),h=new j(n,o),void r(h);h=new j(n,o),r(h)}else{e.pipe(new q).once("data",(function(e){n=8==(15&e[0])?n.pipe(s.createInflate()):n.pipe(s.createInflateRaw()),h=new j(n,o),r(h)}))}})),function(e,t){const r=t.body;null===r?e.end():S(r)?r.stream().pipe(e):Buffer.isBuffer(r)?(e.write(r),e.end()):r.pipe(e)}(y,l)}))}$.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},$.Promise=global.Promise,t.default=$},function(e,t){e.exports=function(e){if("string"!=typeof e)return!1;var t=e.match(r);if(!t)return!1;var i=t[1];if(!i)return!1;if(n.test(i)||o.test(i))return!0;return!1};var r=/^(?:\w+:)?\/\/(\S+)$/,n=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,o=/^[^\s\.]+\.\S{2,}$/},function(e,t,r){const n=r(35),o=r(36).rotateBuffer,i=r(10),a=r(40),s=r(9).promisify,l={};function c(e){let t=null;try{t=a.load(e.toString("binary"))}catch(e){return Promise.reject(new n(l.errors.read_exif,"Could not read EXIF data ("+e+")"))}return Promise.resolve({buffer:e,exifData:t})}function u(e,t,r,i,a){return o(e,t,r,i,a).catch(t=>{throw new n(l.errors.rotate_file,"Could not rotate image ("+t.message+")",e)})}function f(e,t,r,i,a,s){return void 0===t.thumbnail||null===t.thumbnail?Promise.resolve({}):o(Buffer.from(t.thumbnail,"binary"),r,i,a,s).catch(t=>{throw new n(l.errors.rotate_file,"Could not rotate thumbnail ("+t.message+")",e)})}l.errors={read_file:"read_file",read_exif:"read_exif",no_orientation:"no_orientation",unknown_orientation:"unknown_orientation",correct_orientation:"correct_orientation",rotate_file:"rotate_file"},l.rotate=function(e,t,r){const o="function"==typeof r,p="object"==typeof t&&null!==t&&"number"==typeof t.quality&&t.quality>0&&t.quality<=100?t.quality:100,h="object"==typeof t&&null!==t&&"number"==typeof t.jpegjsMaxResolutionInMP&&t.jpegjsMaxResolutionInMP>0?t.jpegjsMaxResolutionInMP:null,m="object"==typeof t&&null!==t&&"number"==typeof t.jpegjsMaxMemoryUsageInMB&&t.jpegjsMaxMemoryUsageInMB>0?t.jpegjsMaxMemoryUsageInMB:null,d=function(e){if("string"==typeof e)return s(i.readFile)(e).catch(e=>{throw new n(l.errors.read_file,"Could not read file ("+e.message+")")});if("object"==typeof e&&Buffer.isBuffer(e))return Promise.resolve(e);return Promise.reject(new n(l.errors.read_file,"Not a file path or buffer"))}(e).then(c).then(({buffer:e,exifData:t})=>{const r=function({buffer:e,exifData:t}){let r=null;t["0th"]&&t["0th"][a.ImageIFD.Orientation]&&(r=parseInt(t["0th"][a.ImageIFD.Orientation]));if(null===r)throw new n(l.errors.no_orientation,"No orientation tag found in EXIF",e);if(isNaN(r)||r<1||r>8)throw new n(l.errors.unknown_orientation,"Unknown orientation ("+r+")",e);if(1===r)throw new n(l.errors.correct_orientation,"Orientation already correct",e);return r}({buffer:e,exifData:t});return Promise.all([u(e,r,p,h,m),f(e,t,r,p,h,m)]).then(([e,n])=>function(e,t,r,n){r["0th"][a.ImageIFD.Orientation]=1,void 0!==r.Exif[a.ExifIFD.PixelXDimension]&&(r.Exif[a.ExifIFD.PixelXDimension]=e.width);void 0!==r.Exif[a.ExifIFD.PixelYDimension]&&(r.Exif[a.ExifIFD.PixelYDimension]=e.height);t.buffer&&(r.thumbnail=t.buffer.toString("binary"));const o=a.dump(r),i=Buffer.from(a.insert(o,e.buffer.toString("binary")),"binary"),s={height:e.height,width:e.width};return Promise.resolve({updatedBuffer:i,orientation:n,updatedDimensions:s})}(e,n,t,r))}).then(({updatedBuffer:e,orientation:t,updatedDimensions:n})=>{if(!o)return{buffer:e,orientation:t,dimensions:n,quality:p};r(null,e,t,n,p)}).catch(e=>{const t=e.buffer;if(delete e.buffer,!o)throw e;r(e,t,null,null,null)});if(!o)return d},e.exports=l},function(e,t){const r=function(e,t,r=null){this.code=e,this.message=t,this.buffer=r,this.stack=(new Error).stack};(r.prototype=Object.create(Error.prototype)).constructor=r,e.exports=r},function(e,t,r){const n=r(37),o={};o.rotateBuffer=function(e,t,r,o,i){let a=null;try{const t={};null!==o&&(t.maxResolutionInMP=o),null!==i&&(t.maxMemoryUsageInMB=i),a=n.decode(e,t)}catch(e){return Promise.reject(e)}let s=a.data;const l={2:{rotate:0,flip:!0},3:{rotate:180,flip:!1},4:{rotate:180,flip:!0},5:{rotate:90,flip:!0},6:{rotate:90,flip:!1},7:{rotate:270,flip:!0},8:{rotate:270,flip:!1}};l[t].rotate>0&&(s=function(e,t,r,n){let o=n/90;for(;o>0;){const n=Buffer.alloc(e.length);let i=0;for(let o=0;o<t;o+=1)for(let a=r-1;a>=0;a-=1){const r=t*a+o<<2,s=e.readUInt32BE(r,!0);n.writeUInt32BE(s,i,!0),i+=4}e=n;const a=t;t=r,r=a,o-=1}return e}(s,a.width,a.height,l[t].rotate));const c=l[t].rotate/90%2==1,u=c?a.height:a.width,f=c?a.width:a.height;l[t].flip&&(s=function(e,t,r){const n=Buffer.alloc(e.length);for(let o=0;o<t;o+=1)for(let i=0;i<r;i+=1){const r=t*i+o<<2,a=t*i+t-1-o<<2,s=e.readUInt32BE(r,!0);n.writeUInt32BE(s,a,!0)}return n}(s,u,f));const p=n.encode({data:s,width:u,height:f},r);return Promise.resolve({buffer:p.data,width:u,height:f})},e.exports=o},function(e,t,r){var n=r(38),o=r(39);e.exports={encode:n,decode:o}},function(e,t,r){function n(e){Math.round;var t,r,n,o,i,a=Math.floor,s=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),p=new Array(65535),h=new Array(64),m=new Array(64),d=[],y=0,g=7,b=new Array(64),S=new Array(64),v=new Array(64),w=new Array(256),P=new Array(2048),x=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],L=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],I=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function O(e,t){for(var r=0,n=0,o=new Array,i=1;i<=16;i++){for(var a=1;a<=e[i];a++)o[t[n]]=[],o[t[n]][0]=r,o[t[n]][1]=i,n++,r++;r*=2}return o}function D(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(y|=1<<g),r--,--g<0&&(255==y?(B(255),B(0)):B(y),g=7,y=0)}function B(e){d.push(e)}function G(e){B(e>>8&255),B(255&e)}function M(e,t,r,n,o){for(var i,a=o[0],s=o[240],l=function(e,t){var r,n,o,i,a,s,l,c,u,f,p=0;for(u=0;u<8;++u){r=e[p],n=e[p+1],o=e[p+2],i=e[p+3],a=e[p+4],s=e[p+5],l=e[p+6];var m=r+(c=e[p+7]),d=r-c,y=n+l,g=n-l,b=o+s,S=o-s,v=i+a,w=i-a,P=m+v,x=m-v,L=y+b,C=y-b;e[p]=P+L,e[p+4]=P-L;var E=.707106781*(C+x);e[p+2]=x+E,e[p+6]=x-E;var R=.382683433*((P=w+S)-(C=g+d)),A=.5411961*P+R,k=1.306562965*C+R,T=.707106781*(L=S+g),I=d+T,O=d-T;e[p+5]=O+A,e[p+3]=O-A,e[p+1]=I+k,e[p+7]=I-k,p+=8}for(p=0,u=0;u<8;++u){r=e[p],n=e[p+8],o=e[p+16],i=e[p+24],a=e[p+32],s=e[p+40],l=e[p+48];var D=r+(c=e[p+56]),B=r-c,G=n+l,M=n-l,j=o+s,F=o-s,_=i+a,U=i-a,N=D+_,z=D-_,H=G+j,X=G-j;e[p]=N+H,e[p+32]=N-H;var q=.707106781*(X+z);e[p+16]=z+q,e[p+48]=z-q;var Y=.382683433*((N=U+F)-(X=M+B)),$=.5411961*N+Y,V=1.306562965*X+Y,J=.707106781*(H=F+M),W=B+J,Z=B-J;e[p+40]=Z+$,e[p+24]=Z-$,e[p+8]=W+V,e[p+56]=W-V,p++}for(u=0;u<64;++u)f=e[u]*t[u],h[u]=f>0?f+.5|0:f-.5|0;return h}(e,t),c=0;c<64;++c)m[x[c]]=l[c];var u=m[0]-r;r=m[0],0==u?D(n[0]):(D(n[p[i=32767+u]]),D(f[i]));for(var d=63;d>0&&0==m[d];d--);if(0==d)return D(a),r;for(var y,g=1;g<=d;){for(var b=g;0==m[g]&&g<=d;++g);var S=g-b;if(S>=16){y=S>>4;for(var v=1;v<=y;++v)D(s);S&=15}i=32767+m[g],D(o[(S<<4)+p[i]]),D(f[i]),g++}return 63!=d&&D(a),r}function j(e){if(e<=0&&(e=1),e>100&&(e=100),i!=e){(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var n=a((t[r]*e+50)/100);n<1?n=1:n>255&&(n=255),s[x[r]]=n}for(var o=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],i=0;i<64;i++){var f=a((o[i]*e+50)/100);f<1?f=1:f>255&&(f=255),l[x[i]]=f}for(var p=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],h=0,m=0;m<8;m++)for(var d=0;d<8;d++)c[h]=1/(s[x[h]]*p[m]*p[d]*8),u[h]=1/(l[x[h]]*p[m]*p[d]*8),h++})(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),i=e}}this.encode=function(e,i){(new Date).getTime();i&&j(i),d=new Array,y=0,g=7,G(65496),G(65504),G(16),B(74),B(70),B(73),B(70),B(0),B(1),B(1),B(0),G(1),G(1),B(0),B(0),function(e){if(e){G(65505),69===e[0]&&120===e[1]&&105===e[2]&&102===e[3]?G(e.length+2):(G(e.length+5+2),B(69),B(120),B(105),B(102),B(0));for(var t=0;t<e.length;t++)B(e[t])}}(e.exifBuffer),function(){G(65499),G(132),B(0);for(var e=0;e<64;e++)B(s[e]);B(1);for(var t=0;t<64;t++)B(l[t])}(),function(e,t){G(65472),G(17),B(8),G(t),G(e),B(3),B(1),B(17),B(0),B(2),B(17),B(1),B(3),B(17),B(1)}(e.width,e.height),function(){G(65476),G(418),B(0);for(var e=0;e<16;e++)B(L[e+1]);for(var t=0;t<=11;t++)B(C[t]);B(16);for(var r=0;r<16;r++)B(E[r+1]);for(var n=0;n<=161;n++)B(R[n]);B(1);for(var o=0;o<16;o++)B(A[o+1]);for(var i=0;i<=11;i++)B(k[i]);B(17);for(var a=0;a<16;a++)B(T[a+1]);for(var s=0;s<=161;s++)B(I[s])}(),G(65498),G(12),B(3),B(1),B(0),B(2),B(17),B(3),B(17),B(0),B(63),B(0);var a=0,f=0,p=0;y=0,g=7,this.encode.displayName="_encode_";for(var h,m,w,x,O,F,_,U,N,z=e.data,H=e.width,X=e.height,q=4*H,Y=0;Y<X;){for(h=0;h<q;){for(F=O=q*Y+h,_=-1,U=0,N=0;N<64;N++)F=O+(U=N>>3)*q+(_=4*(7&N)),Y+U>=X&&(F-=q*(Y+1+U-X)),h+_>=q&&(F-=h+_-q+4),m=z[F++],w=z[F++],x=z[F++],b[N]=(P[m]+P[w+256>>0]+P[x+512>>0]>>16)-128,S[N]=(P[m+768>>0]+P[w+1024>>0]+P[x+1280>>0]>>16)-128,v[N]=(P[m+1280>>0]+P[w+1536>>0]+P[x+1792>>0]>>16)-128;a=M(b,c,a,t,n),f=M(S,u,f,r,o),p=M(v,u,p,r,o),h+=32}Y+=8}if(g>=0){var $=[];$[1]=g+1,$[0]=(1<<g+1)-1,D($)}return G(65497),Buffer.from(d)},function(){(new Date).getTime();e||(e=50),function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=O(L,C),r=O(A,k),n=O(E,R),o=O(T,I),function(){for(var e=1,t=2,r=1;r<=15;r++){for(var n=e;n<t;n++)p[32767+n]=r,f[32767+n]=[],f[32767+n][1]=r,f[32767+n][0]=n;for(var o=-(t-1);o<=-e;o++)p[32767+o]=r,f[32767+o]=[],f[32767+o][1]=r,f[32767+o][0]=t-1+o;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)P[e]=19595*e,P[e+256>>0]=38470*e,P[e+512>>0]=7471*e+32768,P[e+768>>0]=-11059*e,P[e+1024>>0]=-21709*e,P[e+1280>>0]=32768*e+8421375,P[e+1536>>0]=-27439*e,P[e+1792>>0]=-5329*e}(),j(e),(new Date).getTime()}()}e.exports=function(e,t){void 0===t&&(t=50);return{data:new n(t).encode(e,t),width:e.width,height:e.height}}},function(e,t,r){var n=function(){"use strict";var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function t(){}function r(e,t){for(var r,n,o=0,i=[],a=16;a>0&&!e[a-1];)a--;i.push({children:[],index:0});var s,l=i[0];for(r=0;r<a;r++){for(n=0;n<e[r];n++){for((l=i.pop()).children[l.index]=t[o];l.index>0;){if(0===i.length)throw new Error("Could not recreate Huffman Table");l=i.pop()}for(l.index++,i.push(l);i.length<=r;)i.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;o++}r+1<a&&(i.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return i[0].children}function n(t,r,n,o,i,a,s,l,c,u){n.precision,n.samplesPerLine,n.scanLines;var f=n.mcusPerLine,p=n.progressive,h=(n.maxH,n.maxV,r),m=0,d=0;function y(){if(d>0)return d--,m>>d&1;if(255==(m=t[r++])){var e=t[r++];if(e)throw new Error("unexpected marker: "+(m<<8|e).toString(16))}return d=7,m>>>7}function g(e){for(var t,r=e;null!==(t=y());){if("number"==typeof(r=r[t]))return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function b(e){for(var t=0;e>0;){var r=y();if(null===r)return;t=t<<1|r,e--}return t}function S(e){var t=b(e);return t>=1<<e-1?t:t+(-1<<e)+1}var v=0;var w,P=0;function x(e,t,r,n,o){var i=r%f,a=(r/f|0)*e.v+n,s=i*e.h+o;void 0===e.blocks[a]&&u.tolerantDecoding||t(e,e.blocks[a][s])}function L(e,t,r){var n=r/e.blocksPerLine|0,o=r%e.blocksPerLine;void 0===e.blocks[n]&&u.tolerantDecoding||t(e,e.blocks[n][o])}var C,E,R,A,k,T,I=o.length;T=p?0===a?0===l?function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:S(r)<<c;t[0]=e.pred+=n}:function(e,t){t[0]|=y()<<c}:0===l?function(t,r){if(v>0)v--;else for(var n=a,o=s;n<=o;){var i=g(t.huffmanTableAC),l=15&i,u=i>>4;if(0!==l){r[e[n+=u]]=S(l)*(1<<c),n++}else{if(u<15){v=b(u)+(1<<u)-1;break}n+=16}}}:function(t,r){for(var n=a,o=s,i=0;n<=o;){var l=e[n],u=r[l]<0?-1:1;switch(P){case 0:var f=g(t.huffmanTableAC),p=15&f;i=f>>4;if(0===p)i<15?(v=b(i)+(1<<i),P=4):(i=16,P=1);else{if(1!==p)throw new Error("invalid ACn encoding");w=S(p),P=i?2:3}continue;case 1:case 2:r[l]?r[l]+=(y()<<c)*u:0===--i&&(P=2==P?3:0);break;case 3:r[l]?r[l]+=(y()<<c)*u:(r[l]=w<<c,P=0);break;case 4:r[l]&&(r[l]+=(y()<<c)*u)}n++}4===P&&0===--v&&(P=0)}:function(t,r){var n=g(t.huffmanTableDC),o=0===n?0:S(n);r[0]=t.pred+=o;for(var i=1;i<64;){var a=g(t.huffmanTableAC),s=15&a,l=a>>4;if(0!==s){r[e[i+=l]]=S(s),i++}else{if(l<15)break;i+=16}}};var O,D,B,G,M=0;for(D=1==I?o[0].blocksPerLine*o[0].blocksPerColumn:f*n.mcusPerColumn,i||(i=D);M<D;){for(E=0;E<I;E++)o[E].pred=0;if(v=0,1==I)for(C=o[0],k=0;k<i;k++)L(C,T,M),M++;else for(k=0;k<i;k++){for(E=0;E<I;E++)for(B=(C=o[E]).h,G=C.v,R=0;R<G;R++)for(A=0;A<B;A++)x(C,T,M,R,A);if(++M===D)break}if(M===D)do{if(255===t[r]&&0!==t[r+1])break;r+=1}while(r<t.length-2);if(d=0,(O=t[r]<<8|t[r+1])<65280)throw new Error("marker was not found");if(!(O>=65488&&O<=65495))break;r+=2}return r-h}function o(e,t){var r,n,o=[],i=t.blocksPerLine,a=t.blocksPerColumn,s=i<<3,c=new Int32Array(64),u=new Uint8Array(64);function f(e,r,n){var o,i,a,s,l,c,u,f,p,h,m=t.quantizationTable,d=n;for(h=0;h<64;h++)d[h]=e[h]*m[h];for(h=0;h<8;++h){var y=8*h;0!=d[1+y]||0!=d[2+y]||0!=d[3+y]||0!=d[4+y]||0!=d[5+y]||0!=d[6+y]||0!=d[7+y]?(o=5793*d[0+y]+128>>8,i=5793*d[4+y]+128>>8,a=d[2+y],s=d[6+y],l=2896*(d[1+y]-d[7+y])+128>>8,f=2896*(d[1+y]+d[7+y])+128>>8,c=d[3+y]<<4,p=o-i+1>>1,o=o+i+1>>1,i=p,p=3784*a+1567*s+128>>8,a=1567*a-3784*s+128>>8,s=p,p=l-(u=d[5+y]<<4)+1>>1,l=l+u+1>>1,u=p,p=f+c+1>>1,c=f-c+1>>1,f=p,p=o-s+1>>1,o=o+s+1>>1,s=p,p=i-a+1>>1,i=i+a+1>>1,a=p,p=2276*l+3406*f+2048>>12,l=3406*l-2276*f+2048>>12,f=p,p=799*c+4017*u+2048>>12,c=4017*c-799*u+2048>>12,u=p,d[0+y]=o+f,d[7+y]=o-f,d[1+y]=i+u,d[6+y]=i-u,d[2+y]=a+c,d[5+y]=a-c,d[3+y]=s+l,d[4+y]=s-l):(p=5793*d[0+y]+512>>10,d[0+y]=p,d[1+y]=p,d[2+y]=p,d[3+y]=p,d[4+y]=p,d[5+y]=p,d[6+y]=p,d[7+y]=p)}for(h=0;h<8;++h){var g=h;0!=d[8+g]||0!=d[16+g]||0!=d[24+g]||0!=d[32+g]||0!=d[40+g]||0!=d[48+g]||0!=d[56+g]?(o=5793*d[0+g]+2048>>12,i=5793*d[32+g]+2048>>12,a=d[16+g],s=d[48+g],l=2896*(d[8+g]-d[56+g])+2048>>12,f=2896*(d[8+g]+d[56+g])+2048>>12,c=d[24+g],p=o-i+1>>1,o=o+i+1>>1,i=p,p=3784*a+1567*s+2048>>12,a=1567*a-3784*s+2048>>12,s=p,p=l-(u=d[40+g])+1>>1,l=l+u+1>>1,u=p,p=f+c+1>>1,c=f-c+1>>1,f=p,p=o-s+1>>1,o=o+s+1>>1,s=p,p=i-a+1>>1,i=i+a+1>>1,a=p,p=2276*l+3406*f+2048>>12,l=3406*l-2276*f+2048>>12,f=p,p=799*c+4017*u+2048>>12,c=4017*c-799*u+2048>>12,u=p,d[0+g]=o+f,d[56+g]=o-f,d[8+g]=i+u,d[48+g]=i-u,d[16+g]=a+c,d[40+g]=a-c,d[24+g]=s+l,d[32+g]=s-l):(p=5793*n[h+0]+8192>>14,d[0+g]=p,d[8+g]=p,d[16+g]=p,d[24+g]=p,d[32+g]=p,d[40+g]=p,d[48+g]=p,d[56+g]=p)}for(h=0;h<64;++h){var b=128+(d[h]+8>>4);r[h]=b<0?0:b>255?255:b}}l(s*a*8);for(var p=0;p<a;p++){var h=p<<3;for(r=0;r<8;r++)o.push(new Uint8Array(s));for(var m=0;m<i;m++){f(t.blocks[p][m],u,c);var d=0,y=m<<3;for(n=0;n<8;n++){var g=o[h+n];for(r=0;r<8;r++)g[y+r]=u[d++]}}}return o}function i(e){return e<0?0:e>255?255:e}t.prototype={load:function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){var e=new Uint8Array(t.response||t.mozResponseArrayBuffer);this.parse(e),this.onload&&this.onload()}.bind(this),t.send(null)},parse:function(t){var i=1e3*this.opts.maxResolutionInMP*1e3,a=0;t.length;function s(){var e=t[a]<<8|t[a+1];return a+=2,e}function c(){var e=s(),r=t.subarray(a,a+e-2);return a+=r.length,r}function u(e){var t,r,n=0,o=0;for(r in e.components)e.components.hasOwnProperty(r)&&(n<(t=e.components[r]).h&&(n=t.h),o<t.v&&(o=t.v));var i=Math.ceil(e.samplesPerLine/8/n),a=Math.ceil(e.scanLines/8/o);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/n),c=Math.ceil(Math.ceil(e.scanLines/8)*t.v/o),u=i*t.h,f=a*t.v,p=[];l(256*(f*u));for(var h=0;h<f;h++){for(var m=[],d=0;d<u;d++)m.push(new Int32Array(64));p.push(m)}t.blocksPerLine=s,t.blocksPerColumn=c,t.blocks=p}e.maxH=n,e.maxV=o,e.mcusPerLine=i,e.mcusPerColumn=a}var f,p,h=null,m=null,d=[],y=[],g=[],b=[],S=s();if(this.comments=[],65496!=S)throw new Error("SOI not found");for(S=s();65497!=S;){switch(S){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=c();if(65534===S){var w=String.fromCharCode.apply(null,v);this.comments.push(w)}65504===S&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(h={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65505===S&&69===v[0]&&120===v[1]&&105===v[2]&&102===v[3]&&0===v[4]&&(this.exifBuffer=v.subarray(5,v.length)),65518===S&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(m={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var P=s()+a-2;a<P;){var x=t[a++];l(256);var L=new Int32Array(64);if(x>>4==0)for(Y=0;Y<64;Y++){L[e[Y]]=t[a++]}else{if(x>>4!=1)throw new Error("DQT: invalid table spec");for(Y=0;Y<64;Y++){L[e[Y]]=s()}}d[15&x]=L}break;case 65472:case 65473:case 65474:s(),(f={}).extended=65473===S,f.progressive=65474===S,f.precision=t[a++],f.scanLines=s(),f.samplesPerLine=s(),f.components={},f.componentsOrder=[];var C=f.scanLines*f.samplesPerLine;if(C>i){var E=Math.ceil((C-i)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${E}MP`)}var R,A=t[a++];for(X=0;X<A;X++){R=t[a];var k=t[a+1]>>4,T=15&t[a+1],I=t[a+2];f.componentsOrder.push(R),f.components[R]={h:k,v:T,quantizationIdx:I},a+=3}u(f),y.push(f);break;case 65476:var O=s();for(X=2;X<O;){var D=t[a++],B=new Uint8Array(16),G=0;for(Y=0;Y<16;Y++,a++)G+=B[Y]=t[a];l(16+G);var M=new Uint8Array(G);for(Y=0;Y<G;Y++,a++)M[Y]=t[a];X+=17+G,(D>>4==0?b:g)[15&D]=r(B,M)}break;case 65501:s(),p=s();break;case 65500:s(),s();break;case 65498:s();var j=t[a++],F=[];for(X=0;X<j;X++){$=f.components[t[a++]];var _=t[a++];$.huffmanTableDC=b[_>>4],$.huffmanTableAC=g[15&_],F.push($)}var U=t[a++],N=t[a++],z=t[a++],H=n(t,a,f,F,p,U,N,z>>4,15&z,this.opts);a+=H;break;case 65535:255!==t[a]&&a--;break;default:if(255==t[a-3]&&t[a-2]>=192&&t[a-2]<=254){a-=3;break}throw new Error("unknown JPEG marker "+S.toString(16))}S=s()}if(1!=y.length)throw new Error("only single frame JPEGs supported");for(var X=0;X<y.length;X++){var q=y[X].components;for(var Y in q)q[Y].quantizationTable=d[q[Y].quantizationIdx],delete q[Y].quantizationIdx}this.width=f.samplesPerLine,this.height=f.scanLines,this.jfif=h,this.adobe=m,this.components=[];for(X=0;X<f.componentsOrder.length;X++){var $=f.components[f.componentsOrder[X]];this.components.push({lines:o(0,$),scaleX:$.h/f.maxH,scaleY:$.v/f.maxV})}},getData:function(e,t){var r,n,o,a,s,c,u,f,p,h,m,d,y,g,b,S,v,w,P,x,L,C=this.width/e,E=this.height/t,R=0,A=e*t*this.components.length;l(A);var k=new Uint8Array(A);switch(this.components.length){case 1:for(r=this.components[0],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*E],p=0;p<e;p++)m=s[0|p*r.scaleX*C],k[R++]=m;break;case 2:for(r=this.components[0],n=this.components[1],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*E],c=n.lines[0|h*n.scaleY*E],p=0;p<e;p++)m=s[0|p*r.scaleX*C],k[R++]=m,m=c[0|p*n.scaleX*C],k[R++]=m;break;case 3:for(L=!0,this.adobe&&this.adobe.transformCode?L=!0:void 0!==this.opts.colorTransform&&(L=!!this.opts.colorTransform),r=this.components[0],n=this.components[1],o=this.components[2],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*E],c=n.lines[0|h*n.scaleY*E],u=o.lines[0|h*o.scaleY*E],p=0;p<e;p++)L?(m=s[0|p*r.scaleX*C],d=c[0|p*n.scaleX*C],w=i(m+1.402*((y=u[0|p*o.scaleX*C])-128)),P=i(m-.3441363*(d-128)-.71413636*(y-128)),x=i(m+1.772*(d-128))):(w=s[0|p*r.scaleX*C],P=c[0|p*n.scaleX*C],x=u[0|p*o.scaleX*C]),k[R++]=w,k[R++]=P,k[R++]=x;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(L=!1,this.adobe&&this.adobe.transformCode?L=!0:void 0!==this.opts.colorTransform&&(L=!!this.opts.colorTransform),r=this.components[0],n=this.components[1],o=this.components[2],a=this.components[3],h=0;h<t;h++)for(s=r.lines[0|h*r.scaleY*E],c=n.lines[0|h*n.scaleY*E],u=o.lines[0|h*o.scaleY*E],f=a.lines[0|h*a.scaleY*E],p=0;p<e;p++)L?(m=s[0|p*r.scaleX*C],d=c[0|p*n.scaleX*C],y=u[0|p*o.scaleX*C],g=f[0|p*a.scaleX*C],b=255-i(m+1.402*(y-128)),S=255-i(m-.3441363*(d-128)-.71413636*(y-128)),v=255-i(m+1.772*(d-128))):(b=s[0|p*r.scaleX*C],S=c[0|p*n.scaleX*C],v=u[0|p*o.scaleX*C],g=f[0|p*a.scaleX*C]),k[R++]=255-b,k[R++]=255-S,k[R++]=255-v,k[R++]=255-g;break;default:throw new Error("Unsupported color mode")}return k},copyToImageData:function(e,t){var r,n,o,a,s,l,c,u,f,p=e.width,h=e.height,m=e.data,d=this.getData(p,h),y=0,g=0;switch(this.components.length){case 1:for(n=0;n<h;n++)for(r=0;r<p;r++)o=d[y++],m[g++]=o,m[g++]=o,m[g++]=o,t&&(m[g++]=255);break;case 3:for(n=0;n<h;n++)for(r=0;r<p;r++)c=d[y++],u=d[y++],f=d[y++],m[g++]=c,m[g++]=u,m[g++]=f,t&&(m[g++]=255);break;case 4:for(n=0;n<h;n++)for(r=0;r<p;r++)s=d[y++],l=d[y++],o=d[y++],c=255-i(s*(1-(a=d[y++])/255)+a),u=255-i(l*(1-a/255)+a),f=255-i(o*(1-a/255)+a),m[g++]=c,m[g++]=u,m[g++]=f,t&&(m[g++]=255);break;default:throw new Error("Unsupported color mode")}}};var a=0,s=0;function l(e=0){var t=a+e;if(t>s){var r=Math.ceil((t-s)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${r}MB`)}a=t}return t.resetMaxMemoryUsage=function(e){a=0,s=e},t.getBytesAllocated=function(){return a},t.requestMemoryAllocation=l,t}();e.exports=function(e,t={}){var r={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...t},o=new Uint8Array(e),i=new n;i.opts=r,n.resetMaxMemoryUsage(1024*r.maxMemoryUsageInMB*1024),i.parse(o);var a=r.formatAsRGBA?4:3,s=i.width*i.height*a;try{n.requestMemoryAllocation(s);var l={width:i.width,height:i.height,exifBuffer:i.exifBuffer,data:r.useTArray?new Uint8Array(s):Buffer.alloc(s)};i.comments.length>0&&(l.comments=i.comments)}catch(e){throw e instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+s):e}return i.copyToImageData(l,r.formatAsRGBA),l}},function(e,t,r){!function(){"use strict";var r={};function n(e){return f(">"+h("B",e.length),e)}function o(e){return f(">"+h("H",e.length),e)}function i(e){return f(">"+h("L",e.length),e)}function a(e,t,r){var a,s,l,c,u="",p="";if("Byte"==t)(a=e.length)<=4?p=n(e)+h("\0",4-a):(p=f(">L",[r]),u=n(e));else if("Short"==t)(a=e.length)<=2?p=o(e)+h("\0\0",2-a):(p=f(">L",[r]),u=o(e));else if("Long"==t)(a=e.length)<=1?p=i(e):(p=f(">L",[r]),u=i(e));else if("Ascii"==t)(a=(s=e+"\0").length)>4?(p=f(">L",[r]),u=s):p=s+h("\0",4-a);else if("Rational"==t){if("number"==typeof e[0])a=1,l=e[0],c=e[1],s=f(">L",[l])+f(">L",[c]);else{a=e.length,s="";for(var m=0;m<a;m++)l=e[m][0],c=e[m][1],s+=f(">L",[l])+f(">L",[c])}p=f(">L",[r]),u=s}else if("SRational"==t){if("number"==typeof e[0])a=1,l=e[0],c=e[1],s=f(">l",[l])+f(">l",[c]);else{a=e.length,s="";for(m=0;m<a;m++)l=e[m][0],c=e[m][1],s+=f(">l",[l])+f(">l",[c])}p=f(">L",[r]),u=s}else"Undefined"==t&&((a=e.length)>4?(p=f(">L",[r]),u=e):p=e+h("\0",4-a));return[f(">L",[a]),p,u]}function s(e,t,r){var n,o=Object.keys(e).length,i=f(">H",[o]);n=["0th","1st"].indexOf(t)>-1?2+12*o+4:2+12*o;var s="",l="";for(var c in e)if("string"==typeof c&&(c=parseInt(c)),!("0th"==t&&[34665,34853].indexOf(c)>-1||"Exif"==t&&40965==c||"1st"==t&&[513,514].indexOf(c)>-1)){var u=e[c],p=f(">H",[c]),h=y[t][c].type,m=f(">H",[d[h]]);"number"==typeof u&&(u=[u]);var g=a(u,h,8+n+r+l.length);s+=p+m+g[0]+g[1],l+=g[2]}return[i+s,l]}function l(e){var t;if(""==e.slice(0,2))t=function(e){for(var t,r=0;r<e.length;r++)if(""==(t=e[r]).slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null}(m(e)),this.tiftag=t?t.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}if(r.version="1.0.4",r.remove=function(e){var t=!1;if(""==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=u(e.split(",")[1]),t=!0}var r=m(e).filter((function(e){return!(""==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))})).join("");return t&&(r="data:image/jpeg;base64,"+c(r)),r},r.insert=function(e,t){var r=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if(""==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=u(t.split(",")[1]),r=!0}var n=""+f(">H",[e.length+2])+e,o=function(e,t){var r=!1,n=[];e.forEach((function(o,i){""==o.slice(0,2)&&"Exif\0\0"==o.slice(4,10)&&(r?n.unshift(i):(e[i]=t,r=!0))})),n.forEach((function(t){e.splice(t,1)})),!r&&t&&(e=[e[0],t].concat(e.slice(1)));return e.join("")}(m(t),n);return r&&(o="data:image/jpeg;base64,"+c(o)),o},r.load=function(e){var t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if(""==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=u(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}var r={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},n=new l(t);if(null===n.tiftag)return r;"II"==n.tiftag.slice(0,2)?n.endian_mark="<":n.endian_mark=">";var o=p(n.endian_mark+"L",n.tiftag.slice(4,8))[0];r["0th"]=n.get_ifd(o,"0th");var i=r["0th"].first_ifd_pointer;if(delete r["0th"].first_ifd_pointer,34665 in r["0th"]&&(o=r["0th"][34665],r.Exif=n.get_ifd(o,"Exif")),34853 in r["0th"]&&(o=r["0th"][34853],r.GPS=n.get_ifd(o,"GPS")),40965 in r.Exif&&(o=r.Exif[40965],r.Interop=n.get_ifd(o,"Interop")),"\0\0\0\0"!=i&&(o=p(n.endian_mark+"L",i)[0],r["1st"]=n.get_ifd(o,"1st"),513 in r["1st"]&&514 in r["1st"])){var a=r["1st"][513]+r["1st"][514],s=n.tiftag.slice(r["1st"][513],a);r.thumbnail=s}return r},r.dump=function(e){var t,n,o,i,a,l,c=(t=e,JSON.parse(JSON.stringify(t))),u=!1,p=!1,h=!1,y=!1;n="0th"in c?c["0th"]:{},"Exif"in c&&Object.keys(c.Exif).length||"Interop"in c&&Object.keys(c.Interop).length?(n[34665]=1,u=!0,o=c.Exif,"Interop"in c&&Object.keys(c.Interop).length?(o[40965]=1,h=!0,i=c.Interop):Object.keys(o).indexOf(r.ExifIFD.InteroperabilityTag.toString())>-1&&delete o[40965]):Object.keys(n).indexOf(r.ImageIFD.ExifTag.toString())>-1&&delete n[34665],"GPS"in c&&Object.keys(c.GPS).length?(n[r.ImageIFD.GPSTag]=1,p=!0,a=c.GPS):Object.keys(n).indexOf(r.ImageIFD.GPSTag.toString())>-1&&delete n[r.ImageIFD.GPSTag],"1st"in c&&"thumbnail"in c&&null!=c.thumbnail&&(y=!0,c["1st"][513]=1,c["1st"][514]=1,l=c["1st"]);var g,b,S,v=s(n,"0th",0),w=v[0].length+12*u+12*p+4+v[1].length,P="",x=0,L="",C=0,E="",R=0,A="";(u&&(x=(g=s(o,"Exif",w))[0].length+12*h+g[1].length),p&&(C=(L=s(a,"GPS",w+x).join("")).length),h)&&(R=(E=s(i,"Interop",w+x+C).join("")).length);if(y&&(b=s(l,"1st",w+x+C+R),(S=function(e){var t=m(e);for(;""<=t[1].slice(0,2)&&t[1].slice(0,2)<="";)t=[t[0]].concat(t.slice(2));return t.join("")}(c.thumbnail)).length>64e3))throw new Error("Given thumbnail is too large. max 64kB");var k="",T="",I="",O="\0\0\0\0";if(u){var D=f(">L",[B=8+w]);k=f(">H",[34665])+f(">H",[d.Long])+f(">L",[1])+D}if(p){D=f(">L",[B=8+w+x]);T=f(">H",[34853])+f(">H",[d.Long])+f(">L",[1])+D}if(h){D=f(">L",[B=8+w+x+C]);I=f(">H",[40965])+f(">H",[d.Long])+f(">L",[1])+D}if(y){var B;O=f(">L",[B=8+w+x+C+R]);var G="\0\0\0\0"+f(">L",[B+b[0].length+24+4+b[1].length]),M="\0\0\0\0"+f(">L",[S.length]);A=b[0]+G+M+"\0\0\0\0"+b[1]+S}var j=v[0]+k+T+O+v[1];return u&&(P=g[0]+I+g[1]),"Exif\0\0MM\0*\0\0\0\b"+j+P+L+E+A},l.prototype={get_ifd:function(e,t){var r,n={},o=p(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],i=e+2;r=["0th","1st"].indexOf(t)>-1?"Image":t;for(var a=0;a<o;a++){e=i+12*a;var s=p(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],l=[p(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],p(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],this.tiftag.slice(e+8,e+12)];s in y[r]&&(n[s]=this.convert_value(l))}return"0th"==t&&(e=i+12*o,n.first_ifd_pointer=this.tiftag.slice(e,e+4)),n},convert_value:function(e){var t,r=null,n=e[0],o=e[1],i=e[2];if(1==n)o>4?(t=p(this.endian_mark+"L",i)[0],r=p(this.endian_mark+h("B",o),this.tiftag.slice(t,t+o))):r=p(this.endian_mark+h("B",o),i.slice(0,o));else if(2==n)o>4?(t=p(this.endian_mark+"L",i)[0],r=this.tiftag.slice(t,t+o-1)):r=i.slice(0,o-1);else if(3==n)o>2?(t=p(this.endian_mark+"L",i)[0],r=p(this.endian_mark+h("H",o),this.tiftag.slice(t,t+2*o))):r=p(this.endian_mark+h("H",o),i.slice(0,2*o));else if(4==n)o>1?(t=p(this.endian_mark+"L",i)[0],r=p(this.endian_mark+h("L",o),this.tiftag.slice(t,t+4*o))):r=p(this.endian_mark+h("L",o),i);else if(5==n)if(t=p(this.endian_mark+"L",i)[0],o>1){r=[];for(var a=0;a<o;a++)r.push([p(this.endian_mark+"L",this.tiftag.slice(t+8*a,t+4+8*a))[0],p(this.endian_mark+"L",this.tiftag.slice(t+4+8*a,t+8+8*a))[0]])}else r=[p(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],p(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==n)o>4?(t=p(this.endian_mark+"L",i)[0],r=this.tiftag.slice(t,t+o)):r=i.slice(0,o);else if(9==n)o>1?(t=p(this.endian_mark+"L",i)[0],r=p(this.endian_mark+h("l",o),this.tiftag.slice(t,t+4*o))):r=p(this.endian_mark+h("l",o),i);else{if(10!=n)throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+n);if(t=p(this.endian_mark+"L",i)[0],o>1){r=[];for(a=0;a<o;a++)r.push([p(this.endian_mark+"l",this.tiftag.slice(t+8*a,t+4+8*a))[0],p(this.endian_mark+"l",this.tiftag.slice(t+4+8*a,t+8+8*a))[0]])}else r=[p(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],p(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return r instanceof Array&&1==r.length?r[0]:r}},"undefined"!=typeof window&&"function"==typeof window.btoa)var c=window.btoa;if(void 0===c)c=function(e){for(var t,r,n,o,i,a,s,l="",c=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c<e.length;)o=(t=e.charCodeAt(c++))>>2,i=(3&t)<<4|(r=e.charCodeAt(c++))>>4,a=(15&r)<<2|(n=e.charCodeAt(c++))>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),l=l+u.charAt(o)+u.charAt(i)+u.charAt(a)+u.charAt(s);return l};if("undefined"!=typeof window&&"function"==typeof window.atob)var u=window.atob;if(void 0===u)u=function(e){var t,r,n,o,i,a,s="",l=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=c.indexOf(e.charAt(l++))<<2|(o=c.indexOf(e.charAt(l++)))>>4,r=(15&o)<<4|(i=c.indexOf(e.charAt(l++)))>>2,n=(3&i)<<6|(a=c.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=i&&(s+=String.fromCharCode(r)),64!=a&&(s+=String.fromCharCode(n));return s};function f(e,t){if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error("'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.");var r;if("<"==e[0])r=!0;else{if(">"!=e[0])throw new Error("");r=!1}for(var n="",o=1,i=null,a=null,s=null;a=e[o];){if("b"==a.toLowerCase()){if(i=t[o-1],"b"==a&&i<0&&(i+=256),i>255||i<0)throw new Error("'pack' error.");s=String.fromCharCode(i)}else if("H"==a){if((i=t[o-1])>65535||i<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(i%65536/256))+String.fromCharCode(i%256),r&&(s=s.split("").reverse().join(""))}else{if("l"!=a.toLowerCase())throw new Error("'pack' error.");if(i=t[o-1],"l"==a&&i<0&&(i+=4294967296),i>4294967295||i<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(i/16777216))+String.fromCharCode(Math.floor(i%16777216/65536))+String.fromCharCode(Math.floor(i%65536/256))+String.fromCharCode(i%256),r&&(s=s.split("").reverse().join(""))}n+=s,o+=1}return n}function p(e,t){if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");for(var r,n=0,o=1;o<e.length;o++)if("b"==e[o].toLowerCase())n+=1;else if("h"==e[o].toLowerCase())n+=2;else{if("l"!=e[o].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");n+=4}if(n!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+n+":"+t.length);if("<"==e[0])r=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");r=!1}for(var i=[],a=0,s=1,l=null,c=null,u=null,f="";c=e[s];){if("b"==c.toLowerCase())u=1,l=(f=t.slice(a,a+u)).charCodeAt(0),"b"==c&&l>=128&&(l-=256);else if("H"==c)u=2,f=t.slice(a,a+u),r&&(f=f.split("").reverse().join("")),l=256*f.charCodeAt(0)+f.charCodeAt(1);else{if("l"!=c.toLowerCase())throw new Error("'unpack' error. "+c);u=4,f=t.slice(a,a+u),r&&(f=f.split("").reverse().join("")),l=16777216*f.charCodeAt(0)+65536*f.charCodeAt(1)+256*f.charCodeAt(2)+f.charCodeAt(3),"l"==c&&l>=2147483648&&(l-=4294967296)}i.push(l),a+=u,s+=1}return i}function h(e,t){for(var r="",n=0;n<t;n++)r+=e;return r}function m(e){if(""!=e.slice(0,2))throw new Error("Given data isn't JPEG.");for(var t=2,r=[""];;){if(""==e.slice(t,t+2)){r.push(e.slice(t));break}var n=t+p(">H",e.slice(t+2,t+4))[0]+2;if(r.push(e.slice(t,n)),(t=n)>=e.length)throw new Error("Wrong JPEG data.")}return r}var d={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},y={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};y["0th"]=y.Image,y["1st"]=y.Image,r.TAGS=y,r.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},r.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},r.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},r.InteropIFD={InteroperabilityIndex:1},r.GPSHelper={degToDmsRational:function(e){var t=Math.abs(e),r=t%1*60,n=r%1*60;return[[Math.floor(t),1],[Math.floor(r),1],[Math.round(100*n),100]]},dmsRationalToDeg:function(e,t){var r="S"===t||"W"===t?-1:1;return(e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600)*r}},e.exports&&(t=e.exports=r),t.piexif=r}()},function(e,t,r){const n=r(7);e.exports={recognize:async(e,t,r)=>{const o=n(r);return await o.load(),await o.loadLanguage(t),await o.initialize(t),o.recognize(e).finally(async()=>{await o.terminate()})},detect:async(e,t)=>{const r=n(t);return await r.load(),await r.loadLanguage("osd"),await r.initialize("osd"),r.detect(e).finally(async()=>{await r.terminate()})}}},function(e,t){e.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12"}}]));